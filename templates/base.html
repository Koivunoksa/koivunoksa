<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="description" content="{{ config.description }}" />
    <title>{% block title %}{{ config.title }}{% endblock title %}</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Fraunces:wght@400;500;600&family=Space+Grotesk:wght@400;500;600&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="{{ get_url(path="main.css") }}">
    {% block head %}{% endblock head %}
</head>
<body data-lang="en">
    <div class="bark-veil" aria-hidden="true"></div>
    <main>
        <header class="site-header">
            <div class="logo-mark">Koivunoksa</div>
            <div class="header-actions">
                <nav>
                    <a href="#story">
                        <span data-lang-text="en">{{ config.extra.nav_labels.story.en }}</span>
                        <span data-lang-text="fi">{{ config.extra.nav_labels.story.fi }}</span>
                    </a>
                    <a href="#menu">
                        <span data-lang-text="en">{{ config.extra.nav_labels.menu.en }}</span>
                        <span data-lang-text="fi">{{ config.extra.nav_labels.menu.fi }}</span>
                    </a>
                    <a href="#daily">
                        <span data-lang-text="en">{{ config.extra.nav_labels.daily.en }}</span>
                        <span data-lang-text="fi">{{ config.extra.nav_labels.daily.fi }}</span>
                    </a>
                    <a href="#contact">
                        <span data-lang-text="en">{{ config.extra.nav_labels.contact.en }}</span>
                        <span data-lang-text="fi">{{ config.extra.nav_labels.contact.fi }}</span>
                    </a>
                </nav>
                <div class="language-switch" role="group" aria-label="Language switch">
                    <button class="lang-btn is-active" type="button" data-lang-switch="en">EN</button>
                    <button class="lang-btn" type="button" data-lang-switch="fi">FI</button>
                </div>
            </div>
        </header>
        {% block content %}{% endblock content %}
        <footer id="contact">
            <div>
                <strong>
                    <span data-lang-text="en">{{ config.extra.footer_labels.find.en }}</span>
                    <span data-lang-text="fi">{{ config.extra.footer_labels.find.fi }}</span>
                </strong>
                <div>{{ config.extra.address }}</div>
                <div>{{ config.extra.city }}</div>
            </div>
            <div>
                <strong>
                    <span data-lang-text="en">{{ config.extra.footer_labels.contact.en }}</span>
                    <span data-lang-text="fi">{{ config.extra.footer_labels.contact.fi }}</span>
                </strong>
                <div>{{ config.extra.phone }}</div>
                <div>{{ config.extra.contact_email }}</div>
                <div>{{ config.extra.business_id }}</div>
            </div>
            <div>
                <strong>
                    <span data-lang-text="en">{{ config.extra.footer_labels.hours.en }}</span>
                    <span data-lang-text="fi">{{ config.extra.footer_labels.hours.fi }}</span>
                </strong>
                <div>
                    <span data-lang-text="en">{{ config.extra.hours_text.lunch.en }}</span>
                    <span data-lang-text="fi">{{ config.extra.hours_text.lunch.fi }}</span>
                </div>
                <div>
                    <span data-lang-text="en">{{ config.extra.hours_text.dinner.en }}</span>
                    <span data-lang-text="fi">{{ config.extra.hours_text.dinner.fi }}</span>
                </div>
            </div>
        </footer>
    </main>
    <script>
        (function() {
            const storageKey = 'koivunoksaLang';
            const getFromQuery = () => {
                const params = new URLSearchParams(window.location.search);
                const picked = params.get('lang');
                return picked && ['en', 'fi'].includes(picked) ? picked : null;
            };

            const applyLang = (lang) => {
                document.body.dataset.lang = lang;
                document.documentElement.setAttribute('lang', lang);
                document.querySelectorAll('[data-lang-switch]').forEach(btn => {
                    btn.classList.toggle('is-active', btn.dataset.langSwitch === lang);
                });
            };

            const initial = getFromQuery() || window.localStorage.getItem(storageKey) || 'en';
            applyLang(initial);

            document.querySelectorAll('[data-lang-switch]').forEach(btn => {
                btn.addEventListener('click', () => {
                    const lang = btn.dataset.langSwitch;
                    window.localStorage.setItem(storageKey, lang);
                    applyLang(lang);
                });
            });
        })();
    </script>
    {% block scripts %}{% endblock scripts %}
</body>
</html>
