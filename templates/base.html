<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="description" content="{{ config.description }}" />
    <title>{% block title %}{{ config.title }}{% endblock title %}</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Fraunces:wght@400;500;600&family=Space+Grotesk:wght@400;500;600&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="{{ get_url(path="main.css") }}">
    {% block head %}{% endblock head %}
</head>
<body data-lang="en">
    <div class="bark-veil" aria-hidden="true"></div>
    <main>
        {% set home_section = get_section(path="_index.md") %}
        <header class="site-header">
            <div class="logo-mark"><img src="{{ get_url(path="koivunoksalogo.png") }}" alt="Koivunoksa"></div>
            <div class="header-actions">
                <nav>
                    <a href="{{ get_url(path="@/catering.md") }}">
                        <span data-lang-text="en">{{ config.extra.nav_labels.catering.en }}</span>
                        <span data-lang-text="fi">{{ config.extra.nav_labels.catering.fi }}</span>
                    </a>
                </nav>
                <div class="language-switch" role="group" aria-label="Language switch">
                    <button class="lang-btn is-active" type="button" data-lang-switch="en">EN</button>
                    <button class="lang-btn" type="button" data-lang-switch="fi">FI</button>
                </div>
            </div>
        </header>
        {% block content %}{% endblock content %}
        <footer id="contact">
            <div class="footer-info">
                <div>
                    <strong>
                        <span data-lang-text="en">{{ config.extra.footer_labels.find.en }}</span>
                        <span data-lang-text="fi">{{ config.extra.footer_labels.find.fi }}</span>
                    </strong>
                    <div>{{ config.extra.address }}</div>
                    <div>{{ config.extra.city }}</div>
                    {% if home_section.extra.arrival_instructions %}
                    <details class="arrival-details">
                        <summary class="arrival-summary">
                            <span data-lang-text="fi">Saapumisohjeet</span>
                            <span data-lang-text="en">Arrival Instructions</span>
                        </summary>
                        <div class="arrival-content">
                            <div data-lang-text="fi">{{ home_section.extra.arrival_instructions.fi | markdown | safe }}</div>
                            <div data-lang-text="en">{{ home_section.extra.arrival_instructions.en | markdown | safe }}</div>
                        </div>
                    </details>
                    {% endif %}
                </div>
                <div>
                    <strong>
                        <span data-lang-text="en">{{ config.extra.footer_labels.contact.en }}</span>
                        <span data-lang-text="fi">{{ config.extra.footer_labels.contact.fi }}</span>
                    </strong>
                    <div>{{ config.extra.phone }}</div>
                    <div>{{ config.extra.contact_email }}</div>
                    <div>{{ config.extra.business_id }}</div>
                    <div class="social-cluster">
                        <span class="social-title">
                            <span data-lang-text="en">{{ config.extra.footer_labels.social.en }}</span>
                            <span data-lang-text="fi">{{ config.extra.footer_labels.social.fi }}</span>
                        </span>
                        <div class="footer-socials" aria-label="Social media links">
                            {% for social in config.extra.social_links %}
                            <a class="social-link" href="{{ social.url }}" target="_blank" rel="noopener" aria-label="{{ social.name }}">
                                {% if social.icon == "instagram" %}
                                <svg class="social-icon" viewBox="0 0 24 24" role="img" aria-hidden="true">
                                    <path d="M16.5 2h-9A5.5 5.5 0 002 7.5v9A5.5 5.5 0 007.5 22h9a5.5 5.5 0 005.5-5.5v-9A5.5 5.5 0 0016.5 2zm3.5 14.5A3.5 3.5 0 0116.5 20h-9A3.5 3.5 0 014 16.5v-9A3.5 3.5 0 017.5 4h9A3.5 3.5 0 0120 7.5z" />
                                    <path d="M12 7.5A4.5 4.5 0 1016.5 12 4.5 4.5 0 0012 7.5zm0 7A2.5 2.5 0 1114.5 12 2.5 2.5 0 0112 14.5z" />
                                    <circle cx="17.5" cy="6.5" r="1.1" />
                                </svg>
                                {% elif social.icon == "facebook" %}
                                <svg class="social-icon" viewBox="0 0 24 24" role="img" aria-hidden="true">
                                    <path d="M15 4h2.5V0H15a5 5 0 00-5 5v3H7v4h3v12h4V12h3.2l.6-4H14V5a1 1 0 011-1z" />
                                </svg>
                                {% endif %}
                                <span>{{ social.name }}</span>
                            </a>
                            {% endfor %}
                        </div>
                    </div>
                </div>
                <div>
                    <strong>
                        <span data-lang-text="en">{{ config.extra.footer_labels.hours.en }}</span>
                        <span data-lang-text="fi">{{ config.extra.footer_labels.hours.fi }}</span>
                    </strong>
                    <div>
                        <span data-lang-text="en">{{ config.extra.hours_text.lunch.en }}</span>
                        <span data-lang-text="fi">{{ config.extra.hours_text.lunch.fi }}</span>
                    </div>
                </div>
            </div>
            <div class="footer-map-section">
                <strong>
                    <span data-lang-text="en">{{ config.extra.footer_labels.map.en }}</span>
                    <span data-lang-text="fi">{{ config.extra.footer_labels.map.fi }}</span>
                </strong>
                <div class="map-embed">
                    <iframe
                        src="{{ config.extra.map_embed_url }}"
                        loading="lazy"
                        referrerpolicy="no-referrer-when-downgrade"
                        allowfullscreen
                        title="Koivunoksa map">
                    </iframe>
                </div>
            </div>
            <div style="margin-top: 2rem; text-align: center; opacity: 0.6; font-size: 0.8rem;">
                <a href="https://www.oivahymy.fi/api/raportti/223921" target="_blank" rel="noopener" style="text-decoration: none; color: inherit;">Oiva</a>
            </div>
        </footer>
    </main>
    <script>
        (function() {
            const storageKey = 'koivunoksaLang';
            const getFromQuery = () => {
                const params = new URLSearchParams(window.location.search);
                const picked = params.get('lang');
                return picked && ['en', 'fi'].includes(picked) ? picked : null;
            };

            const applyLang = (lang) => {
                document.body.dataset.lang = lang;
                document.documentElement.setAttribute('lang', lang);
                document.querySelectorAll('[data-lang-switch]').forEach(btn => {
                    btn.classList.toggle('is-active', btn.dataset.langSwitch === lang);
                });
            };

            const initial = getFromQuery() || window.localStorage.getItem(storageKey) || 'en';
            applyLang(initial);

            document.querySelectorAll('[data-lang-switch]').forEach(btn => {
                btn.addEventListener('click', () => {
                    const lang = btn.dataset.langSwitch;
                    window.localStorage.setItem(storageKey, lang);
                    applyLang(lang);
                });
            });
        })();
    </script>
    {% block scripts %}{% endblock scripts %}
</body>
</html>
